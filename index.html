<doctype HTML></doctype>
<html>
<head>
<script type ="text/javascript" src="server.js"></script>
</head>

<style>
    html, body {
       width: 100%;
       height: 100%;
       margin: 0px;
    }
    
    #mijnCanvasje{
        border: 5px solid black;
        background-color: black;
    }
#balkLinks{
   -webkit-transition: all;
   transition: all;
   position:absolute;
   width:10px;
   background: #fff;
}
</style>

<body onload='init()'>
    <canvas id="mijnCanvasje" width="500" height="500" style="1px solid black"></canvas>
    <div id="balkLinks"></div>
    <div id="balkRechts"></div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
       if ( !window.requestAnimationFrame ) { // Deze methode vertelt de browser dat je een animatie wilt uitvoeren
       window.requestAnimationFrame = ( function() {
           return window.webkitRequestAnimationFrame ||
           window.mozRequestAnimationFrame || //voor Firefox
           window.oRequestAnimationFrame || //voor Opera
           window.msRequestAnimationFrame || //voor internet explorer
           
           function( /* function FrameRequestCallback */ callback, /* DOMElement Element */ element ) {
               window.setTimeout( callback, 1000 / 60 );
           }; 
       } )(); 
   }
   
    function startDrawing(canvasId) {
      var canvasElement = document.getElementById(canvasId);
      var drawingContext = canvasElement.getContext("2d");
      return drawingContext;
   }
 
    var theContext = startDrawing("mijnCanvasje")

    var canvasWidth = window.innerWidth
    var canvasHeight = window.innerHeight
    var theContext = startDrawing("mijnCanvasje")
    window.addEventListener('resize', resizeCanvas, false)
    function resizeCanvas() {
      mijnCanvasje.width = canvasWidth
      mijnCanvasje.height = canvasHeight
    }
    resizeCanvas();
        
   var x = 100;  // houdt de veranderende horizontale positie bij
   var y = 100;  // houd de veranderende verticale positie bij
   var frameTeller = 0;
   var stapX = 5;    // De X-as snelheid (in frames) per seconde
   var stapY = 5;    // De Y-as snelheid (in frames) per seconde
   var straal = 10;  // De straal van de bal
   var hoogtePlatform = 75;   // De hoogte van de platform (in pixels)
   var platform1X = 20  // Beginpositie X-as platform links
   var platform1Y    // Beginpositie Y-as (niet ingesteld)
   var onderkantPlatform1
   var bovenkantPlatform1
   var platform2X    // Beginpositie X-as platform rechts
   var platform2Y     // Beginpositie Y-as platform rechts
   var onderkantPlatform2
   var bovenkantPlatform2
    
   function drawPlatform(thisPlatform) {   // Tekent het platform links
        theContext.beginPath();
        theContext.rect(100, 100, 10, 75)
        theContext.closePath();
        theContext.fill();
        theContext.fillStyle='white';
   }
   

   function init(){
      balk = document.getElementById("balkLinks");
      w = canvasWidth;
      h = canvasHeight;
   
      balk.style.left = w-25+"px"; //positie balk
      balk.style.top = (h/2)-50+"px";
      balk.snelheid = {x:0,y:0}
      balk.positie = {x:480,y:100}
    
      if (window.DeviceOrientationEvent) {
         window.addEventListener("deviceorientation", function(event) {
            balk.snelheid.y = Math.round(event.beta); //beta is je mobiel kantelen via de lengte.
            balk.snelheid.x = Math.round(event.gamma); //gamma is je mobiel kantelen via de breedte.
         } )
      }; 
       
   update();
   }

   function update(){
           balk.positie.y += balk.snelheid.y;
            
            if(balk.positie.y < 0 && balk.snelheid.y < 0){ //bovenkant
               balk.positie.y = 0;
            }

            if(balk.positie.y > 300 && balk.snelheid.y > 0){ //onderkant
               balk.positie.y = 300;
            }

         balk.style.top = balk.positie.y + "px"
         //platform2Y = balk.positie.y + 20
       
       requestAnimationFrame( update );//KEEP ANIMATING
   }
        
drawPlatform();
init();


//
//        
//    var socket = io.connect();
//        
//    socket.on('canvas', function(platformArr){
//       
//        theContext.clearRect(0,0,500,300);
//        
//        for(var i=0;i<platformArr.length;i++){
//            var thisPlatform=platformArr[i];
//            drawPlatform(thisPlatform);
//            console.log('>>>>', i, thisPlatform);
//        }
//        
//    socket.emit('movement', init)
//        
//    });
  
    
      
  </script>
</body>
</html>